# Linux 介绍



## 1.Linux版本分类

- 内核版： 由内核官网进行发布（www.kernel.org）

  > RHEL6.x         对应内核2.6.x
  >
  > RHEL7.x		 对应内核3.10.x

- 发行版：主要有RedHat系列和Debian系列。

  > RedHat系列有个人版 Fedora， 服务器版有RHEL(RedHat Enterprise Linux)
  >
  > *CentOS, gentoo linux, SuSE, MAndriva, turbolinux* 
  >
  > Debian系列有ubuntu和KNOPPIX(*服务器不推荐*)



## 2.Linux开源软件

- Apache, Nginx 最流行的web服务器
- MySQL: 最流行的数据库（SQLserver, Oracle性能更强，但是收费）
- PHP, Python, Ruby 脚本语言



# 1.了解linux目录结构



## 一级目录

**/bin/:** /usr/bin/目录的软链接

**/sbin/:** /usr/sbin/目录的软链接

**/lib/ & /lib64/:** 上述两者的软链接 

**/boot/:** 系统启动必备信息

**/dev/:** 设备文件保存位置

**/var/:**保存动态数据的位置

**/home/:** 普通用户的家目录。在创建用户时，每个用户要要有一个默认登录和保存自己数据的位置，就是用户的家目录。如用户user1的家目录就是/home/user1/。**~** 指当前用户的家。root用户的家在/root/

**/media/ & /misc/ & /mnt/ :** 用来当挂载点的空目录

**/opt/:** 第三方软件的保存位置，/usr/local也可以用来安装保存软件。

**/proc/:**

**/sys/:**

**/selinux/:** linux增强安全组件

**/srv/:** 服务数据目录。

**/tmp/:** 临时目录。系统存放临时文件的目录。最好每次开机都把该目录清空。

**/usr/:** 系统软件资源目录。是“UNIX Software Resource”的缩写。不是存放用户数据的目录，而是存放系统软件资源的目录。系统中安装的软件大部分保存在这里。 



## 二级目录

**/usr/bin/:** 存放系统命令的目录，普通用户与超级用户都可以执行

**/usr/sbin/:** 存放系统命令的目录，超级用户才可以执行。

**/usr/lib/:** 系统调用的函数库保存位置

**/usr/lib64/:** 64位函数库保存位置

**/usr/local/:** 手工安装的软件的保存位置。

**/usr/src/:** 源码包保存位置。更建议放在**/usr/local/src/**下，把内核源码保存到**/usr/src/kernels/**目录中。

**/var/www/html/:** RPM包安装的Apache的网页主目录。

**/var/lib/：**程序运行中需要调用或者改变的数据保存位置。如MySQL的数据保存在/var/lib/mysql/目录中。

**/var/log/:** 系统日志保存位置。

**/var/run/:** 一些服务和程序运行后，他们的进程的保存位置。是/run/位置的软链接。

**/var/spool/mail/: **新收到的邮件队列位置。系统新收到的邮件会保存到该位置

**/var/spool//:** 定时任务位置



## 服务器建议

##### 1. 远程服务器不能关机只能重启 

> 建议使用shutdown -r now命令重启。最后在重启之前执行几次“sycn”同步内存数据到硬盘中。

##### 2.重启前，要中止正在执行的服务

> 硬盘在高速存储时断电或重启非常容易造成硬盘损坏。因为很多人访问。

##### 3.不要在服务器访问高峰运行高负载命令

> 可能会导致服务器响应缓慢甚至死机。 比如复制大量数据，压缩或者解压大文件，大范围的硬盘搜索等。高峰期一般在17.00-24.00期，低峰期在4.00-5.00通过定时任务执行这些命令。

##### 4.远程配置防火墙时不要把自己踢出服务器

> **防火墙**：防火墙的基本功能是数据包过滤（靠IP, MAC地址， 端口号， 协议类型， 数据包中的数据）
>
> linux防火墙配置完全是靠手工命令完成的，配置规则和配置命令相对也比较复杂，万一设置时心不在焉就完蛋了。（无法通过重启清空防火墙规则）**可以先写一个系统定时任务，每隔五分钟清空一下防火墙规则，测试完成后再关闭这个定时任务。**

##### 5.合理分配权限：给予用户最小权限

##### 6.定期备份重要数据和日志: 不要把鸡蛋放在一个篮子里。





# Linux命令大全（也可用man和--help）

<https://man.linuxde.net/ls>

#### ls-列出文件夹文件

#### cd-进入目录

| 特殊符号 | 作用             |
| -------- | ---------------- |
| ~        | 代表用户的家目录 |
| -        | 代表上次所在目录 |
| .        | 代表当前目录     |
| ..       | 代表上级目录     |

#### pwd-显示你在哪

#### mkdir-建立目录（不能同名）

#### rmdir-删除目录 （只能删除空目录，不好用）

#### wc-统计文件信息（包括字节数，单词数和行数）

> **-c：** 字节数
>
> **-w：** 单词数
>
> **-l：** 统计行数
>
> **wc <** 加文件名 和不加效果相同
>
> **wc << uio**  第二个uio标志结束，输出中间内容的信息

#### echo-打印

> **-n:** 取消输出后行末的换行符号
>
> **-e:** 支持反斜线控制的字符转换 

#### grep-搜索

> grep [**选项**] “搜索内容” 文件名
>
> *以下为选项内容*
>
> **-A 数字：** 列出符合条件的行，并列出后续的n行
>
> **-B 数字：** 列出符合条件的行，并列出前面的n行
>
> **-c:** 统计找到的符合条件的字符串的次数
>
> **-i:** 忽略大小写
>
> **-n:**  输出行号
>
> **-v:**  反向查找



## 文件操作命令

### touch-创建空文件或修改文件时间

> 如果没有该文件就新建，如果有文件就更新该文件的访问的时间

### rm-删除文件

> **rm -rf 123** **最危险的命令** 	递归删除文件夹

### stat-查看文件详细信息的命令

> 访问时间：
>
> 最近更改： 数据修改时间
>
> 最近改变：状态修改时间



## 进程相关

### pstree-查看进程树



## 未归类

### history

> **-w:** 把缓存中的历史命令直接写入**./bash_history**
>
> **-c:** 清空历史命令 （不哟轻易执行）
>
> 如何使用历史命令：
>
> 1. 上下箭头
> 2. ！n 第n条历史命令
> 3. ！！重复执行上一条命令

### alias别名

> **配置在.bashrc里面**
>
> **执行顺序:**
>
> 1. 绝对路径或者是相对路径
> 2. 执行别名
> 3. 执行bash的内部命令
> 4. 按照$PATH环境变量定义的目录查找顺序找到的第一个命令

### source 或者 .

> **使配置文件无需重启直接生效**

### read \[选项\] \[变量名]

> **-p "提示信息"：** 在等待read输入时，输出提示信息。
>
> **-t 秒数：** read命令会一直等待用户输入，此选项可以指定等待时间
>
> **-n 字符数：** 可输入的最厂输入长度
>
> **例子：** read -n 2 -t 30 -p "Please input the number 1: " num1

## Declare [+/-\] [选项] 变量名

> -：给变量设定类型属性
>
> +: 取消变量的类型属性
>
> -a: 将变量声明为数组型
>
> -i: 将变量声明为整数型 （  **$(())能达到同样的效果**  ）
>
> -r: 给变量设定只读属性，让变量无法修改。(**declare +r无法修改，开机或重启会自动取消属性**)
>
> -x: 声明环境变量
>
> -p: 查询









# 一.Shell概述



#### 1. 什么是shell

**shell是命令解释器，把命令翻译给内核来看。并支持脚本（命令集合）**

**Linux的shell叫Bourne Again(Bash)**



#### 2.规则

- 第一行一定要写 **#!/bin/bash**




## Shell的变量和运算符



#### 变量规则

- 不能以数字开头

- 变量的默认类型是字符串，如果要进行数值运算，则必须制定变量类型为数值型。

- 用等号连接，等号两侧不能有空格

- 变量的值如果有空格，需要使用单引号或者双引号包括。如：“test="hello world!""

- 变量中可以加入转义符

- 可以进行变量值的叠加 例如：**test=”$test“789**

- 输出数组元素需要特定的格式：**${name[x]}**, 如果是**${name[*]}**则一口气输出所有数组元素

  ​



#### 变量分类

- ##### 用户自定义变量

- ##### 环境变量

> $PATH: 和windows一致
>
> $PS1: 修改标志符
>
> $LANG：系统当前编码

- ##### 位置参数变量（只能修改值）

> **$n**,  数字代表是第几个参数. 命令本身占一个参数位置（\$0）， 大于10的参数需要用${10}的形式来写
>
> **$*,**  代表命令行中所有的参数，**把所有的参数当作一个整体**
>
> **$@,** 代表所有参数,**但每个参数区别对待**
>
> **$#,** 代表所有参数的个数

- ##### 预定义变量 （只能修改值）

> **$?:**  最后一次执行的命令的返回状态。如果这个变量的值为0，证明上一个命令正确执行。反之执行不正确。
>
> **$$:** 当前进程的PID号
>
> **$!:** 后台运行的最后一个进程的进程号（PID）



### 运算方法

- expr c=\$a + \$b
- let c = \$a+\$b
- $(())  **推荐**
- $[]  **推荐**




### Shell运算符

| 算术运算符 | 说明                                          | 举例                          |
| ---------- | --------------------------------------------- | ----------------------------- |
| +          | 加法                                          | `expr $a + $b` 结果为 30。    |
| -          | 减法                                          | `expr $a - $b` 结果为 -10。   |
| *          | 乘法                                          | `expr $a \* $b` 结果为  200。 |
| /          | 除法                                          | `expr $b / $a` 结果为 2。     |
| %          | 取余                                          | `expr $b % $a` 结果为 0。     |
| =          | 赋值                                          | a=$b 将把变量 b 的值赋给 a。  |
| ==         | 相等。用于比较两个数字，相同则返回 true。     | [ $a == $b ] 返回 false。     |
| !=         | 不相等。用于比较两个数字，不相同则返回 true。 | [ $a != $b ] 返回 true。      |

| 关系运算符 | 说明                                                  | 举例                       |
| ---------- | ----------------------------------------------------- | -------------------------- |
| -eq        | 检测两个数是否相等，相等返回 true。                   | [ $a -eq $b ] 返回 false。 |
| -ne        | 检测两个数是否不相等，不相等返回 true。               | [ $a -ne $b ] 返回 true。  |
| -gt        | 检测左边的数是否大于右边的，如果是，则返回 true。     | [ $a -gt $b ] 返回 false。 |
| -lt        | 检测左边的数是否小于右边的，如果是，则返回 true。     | [ $a -lt $b ] 返回 true。  |
| -ge        | 检测左边的数是否大于等于右边的，如果是，则返回 true。 | [ $a -ge $b ] 返回 false。 |
| -le        | 检测左边的数是否小于等于右边的，如果是，则返回 true。 | [ $a -le $b ] 返回 true。  |

| 逻辑运算符 | 说明                                                | 举例                                     |
| ------ | --------------------------------------------------- | ---------------------------------------- |
| !      | 非运算，表达式为 true 则返回 false，否则返回 true。 | [ ! false ] 返回 true。                  |
| -o     | 或运算，有一个表达式为 true 则返回 true。           | [ $a -lt 20 -o $b -gt 100 ] 返回 true。  |
| -a     | 与运算，两个表达式都为 true 才返回 true。           | [ $a -lt 20 -a $b -gt 100 ] 返回 false。 |

| 字符串运算符 | 说明                                      | 举例                     |
| ------------ | ----------------------------------------- | ------------------------ |
| =            | 检测两个字符串是否相等，相等返回 true。   | [ $a = $b ] 返回 false。 |
| !=           | 检测两个字符串是否相等，不相等返回 true。 | [ $a != $b ] 返回 true。 |
| -z           | 检测字符串长度是否为0，为0返回 true。     | [ -z $a ] 返回 false。   |
| -n           | 检测字符串长度是否为0，不为0返回 true。   | [ -n "$a" ] 返回 true。  |
| $            | 检测字符串是否为空，不为空返回 true。     | [ $a ] 返回 true。       |


| 文件测试操作符 | 说明                                                         | 举例                      |
| -------------- | ------------------------------------------------------------ | ------------------------- |
| -b file        | 检测文件是否是块设备文件，如果是，则返回 true。              | [ -b $file ] 返回 false。 |
| -c file        | 检测文件是否是字符设备文件，如果是，则返回 true。            | [ -c $file ] 返回 false。 |
| -d file        | 检测文件是否是目录，如果是，则返回 true。                    | [ -d $file ] 返回 false。 |
| -f file        | 检测文件是否是普通文件（既不是目录，也不是设备文件），如果是，则返回 true。 | [ -f $file ] 返回 true。  |
| -g file        | 检测文件是否设置了 SGID 位，如果是，则返回 true。            | [ -g $file ] 返回 false。 |
| -k file        | 检测文件是否设置了粘着位(Sticky Bit)，如果是，则返回 true。  | [ -k $file ] 返回 false。 |
| -p file        | 检测文件是否是有名管道，如果是，则返回 true。                | [ -p $file ] 返回 false。 |
| -u file        | 检测文件是否设置了 SUID 位，如果是，则返回 true。            | [ -u $file ] 返回 false。 |
| -r file        | 检测文件是否可读，如果是，则返回 true。                      | [ -r $file ] 返回 true。  |
| -w file        | 检测文件是否可写，如果是，则返回 true。                      | [ -w $file ] 返回 true。  |
| -x file        | 检测文件是否可执行，如果是，则返回 true。                    | [ -x $file ] 返回 true。  |
| -s file        | 检测文件是否为空（文件大小是否大于0），不为空返回 true。     | [ -s $file ] 返回 true。  |
| -e file        | 检测文件（包括目录）是否存在，如果是，则返回 true。          | [ -e $file ] 返回 true。  |



### Bash常用快捷键

| 快捷键 | 作用               |
| ------ | ------------------ |
| ctrl+A | 移到命令行开头     |
| ctrl+E | 移到命令行结尾     |
| ctrl+C | 强制终止当前命令   |
| ctrl+L | 清屏               |
| ctrl+U | 剪切光标之前的命令 |
| ctrl+K | 剪切光标后内的内容 |
| ctrl+Y | 粘贴内容           |
| ctrl+Z | 放入后台           |



### bash输入输出重定向

|                    |                         |                       |
| ------------------ | ----------------------- | --------------------- |
| 标准输入输出流     | **>**                   | 覆盖                  |
|                    | **>>**                  | 追加                  |
| 标准错误输出重定向 | **2>**                  | 覆盖                  |
|                    | **2>>**                 | 追加                  |
| 正确与错误同时保存 | **>文件 2>&1**          | 覆盖同一个            |
|                    | **>>文件 2>&1**         | 追加同一个            |
|                    | **&>**                  | 覆盖同一个            |
|                    | **&>>**                 | 追加同一个            |
|                    | **>> 文件1   2>>文件2** | 正确追加到1， 错误到2 |



### 多命令顺序执行

- **加分号：**多个命令顺序执行，命令之间没有任何逻辑联系

> 命令1 ； 命令2

- **&&：** 当命令1正确执行，命令2才会被执行。当命令1执行不正确，命令2不会被执行。

> 命令1 && 命令2

- **||：** 当命令1错误，命令2才会被执行.

> 命令1 || 命令2
>
> ***可以把&&和||联合运用来是实现if else的判断***
>
> 命令1 && 命令2 || 命令3



### 通配符

### 特殊符号

| 符号       | 说明                                           |
| ---------- | ---------------------------------------------- |
| **' '**    | 普通字符                                       |
| **" "**    | 保留特殊符号的含义                             |
| **$**      | 引用变量名                                     |
| **$( )**   | 和反引号作用一样，用来引用系统命令             |
| **( )**    | 在子shell中运行，当命令执行完，子shell自动退出 |
| **{ }**    | 直接在父shell中运行，和不写{}效果一致          |
| **[ ]**    | 变量测试                                       |
| \          | 转义符，让特殊符号失去特殊含义                 |
| **${ }**   | 用来正确获取数组里的值                         |
| **$(( ))** | 计算算式                                       |
| **$[ ]**   | 计算算式                                       |

> $举例：lala = date
>
> \$("\$lala")

> name=name1
>
> (name=name2; echo $name)
>
> 执行输出 **name2**
>
> echo $name
>
> 执行输出 **name1**



## 环境变量配置文件

- 用户登录过程先调用/etc/profile文件